{"version":3,"sources":["../waterfall.js"],"names":["Waterfall","container","style","position","cont","colInfo","left","height","urls","boxs","imgSrc","addImg","window","onresize","e","elem","adjustPos","concat","url","aBox","document","createElement","visibility","className","pic","img","appendChild","push","setAttribute","onload","target","parentNode","length","i","clientWidth","index","getTopPosIndex","top","offsetHeight"],"mappings":"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","file":"waterfall.js","sourcesContent":["\"use strict\";\r\n\r\nclass Waterfall{\r\n    constructor (container) {\r\n        container.style.position = \"relative\";\r\n        this.cont = container;\r\n        this.colInfo = {\r\n            left:[],\r\n            height:[]\r\n        };\r\n        this.urls = [];\r\n        this.boxs = [];\r\n    }\r\n    create(){\r\n        for (let imgSrc of this.urls){\r\n            this.addImg(imgSrc);\r\n        }\r\n        window.onresize = (e)=>{\r\n            this.colInfo = {\r\n                left:[],\r\n                height:[]\r\n            };\r\n            for (let elem of this.boxs)\r\n            {\r\n                this.adjustPos(elem);\r\n            }\r\n        };\r\n    }\r\n    addUrls(urls){\r\n        this.urls = this.urls.concat(urls);\r\n    }\r\n    addImg(url){\r\n        let aBox = document.createElement(\"div\");\r\n        aBox.style.visibility = \"hidden\";\r\n        aBox.className = \"box\";\r\n        let pic = document.createElement(\"div\");\r\n        pic.className = \"pic\";\r\n        let img = document.createElement(\"img\");\r\n        pic.appendChild(img)\r\n        aBox.appendChild(pic);\r\n        this.cont.appendChild(aBox);\r\n        this.boxs.push(aBox);\r\n        img.setAttribute(\"src\", url);\r\n        img.onload = (e)=>{\r\n            let elem = e.target.parentNode.parentNode;\r\n            this.adjustPos(elem, this.colInfo);\r\n            elem.style.visibility = \"visible\";\r\n        };\r\n    }\r\n    getTopPosIndex(){\r\n        if (this.colInfo.height.length < 4)\r\n        {\r\n            let i = this.colInfo.height.length;\r\n            this.colInfo.left[i] = (this.cont.clientWidth*0.25)*i;\r\n            this.colInfo.height[i] = 0;\r\n            return i;\r\n        }\r\n\r\n        // find the min height and related left\r\n        let height = this.colInfo.height[0];\r\n        let index = 0;\r\n        for (let i=1;i <this.colInfo.height.length;i++)\r\n        {\r\n            if (this.colInfo.height[i]<height)\r\n            {\r\n                index = i;\r\n            }\r\n        }\r\n        return index;\r\n    }\r\n    adjustPos(elem){\r\n        let i = this.getTopPosIndex(this.colInfo);\r\n        elem.style.position = \"absolute\";\r\n        elem.style.top = this.colInfo.height[i] + \"px\";\r\n        elem.style.left = this.colInfo.left[i]  + \"px\";\r\n        this.colInfo.height[i] += elem.offsetHeight;\r\n        return {top: elem.style.top, left: elem.style.left};\r\n    }\r\n}"]}